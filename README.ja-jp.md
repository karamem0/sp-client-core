# SPClientCore

[View in English](README.md)

PowerShell 向けの SharePoint サービス モジュール

[![.github/workflows/trigger-on-main.yml](https://github.com/karamem0/sp-client-core/actions/workflows/trigger-on-main.yml/badge.svg)](https://github.com/karamem0/sp-client-core/actions/workflows/trigger-on-main.yml)
[![codecov](https://codecov.io/gh/karamem0/sp-client-core/graph/badge.svg?token=W4W9CALNPA)](https://codecov.io/gh/karamem0/sp-client-core)
[![License](https://img.shields.io/github/license/karamem0/sp-client-core.svg)](https://github.com/karamem0/sp-client-core/blob/main/LICENSE)

## インストール

SPClientCore は [PowerShell Gallery](https://www.powershellgallery.com/packages/SPClientCore) に公開されています。

## 機能

### PowerShell 7 での動作

はい、SPClientCore は最新バージョンの PowerShell 7 で動作しします。つまり、このモジュールを Windows はもちろん Mac や Linux でも使用できるということです (もちろんそのマシンに PowerShell 7 がインストールされていればですが)。<del>Windows 以外の環境で SharePoint Online を管理するには REST API を実行する方法しかありませんでした。</del>しかし REST API は SharePoint クライアント ライブラリ (CSOM) に比べていくつかの問題を持っています。SPClientCore は SharePoint クライアント ライブラリと互換性のある API 呼び出しを行うことで完全な機能を提供します。

*(更新) CSOM および PnP PowerShell は PowerShell 7 をサポートしました。*

### 1 つのモジュールですべての管理を

SPClientCore はサイト管理者機能とテナント管理機能の両方の要素を含んでいます。一般のサイト (`https://tenant.sharepoint.com` およびその配下の URL) に接続すればサイト管理のためのコマンドレットを実行することができ、SharePoint 管理センター (`https://tenant-admin.sharepoint.com`) に接続すればテナント管理のためのコマンドレットを実行することができます。現在 SharePoint 管理センターに接続しているかどうかを確認することもできます。

### フレンドリーな名前付け

CSOM の名前付けは非プログラマーにとって難解です。例えば、サイトは "Site" ではありません (正しくは "Web" です) し、列は "Column" ではありません (正しくは "Field" です)。SPClientCoreはユーザーが使用する名前と一致するように名前付けを調整しています。

### 先端認証の使用

SPClientCore は Microsoft Entra ID 2.0 認証をサポートします。

- デバイス コード認証
- クライアント クレデンシャル認証
- <s>パスワード認証</s> (廃止)

もしあなたが MFA を有効にしていても異なるデバイスの Web ブラウザーでログインすることができます。MFA を有効にしていないアカウントであれば、ユーザー名とパスワードを使ってログインできます (組織の承認が必要です)。資格情報はキャッシュされるので何度もログインする必要はありません。

## 依存関係

- [Microsoft.ApplicationInsights](https://www.nuget.org/packages/Microsoft.ApplicationInsights/2.22.0) (2.22.0)
- [Microsoft.Extensions.Configuration.Json](https://www.nuget.org/packages/Microsoft.Extensions.Configuration.Json/8.0.1) (8.0.1)
- [Microsoft.Extensions.Configuration.EnvironmentVariables](https://www.nuget.org/packages/Microsoft.Extensions.Configuration.EnvironmentVariables/8.0.0) (8.0.0)
- [Microsoft.Extensions.DependencyInjection](https://www.nuget.org/packages/Microsoft.Extensions.DependencyInjection/8.0.1) (8.0.1)
- [Microsoft.Extensions.DependencyInjection.Abstractions](https://www.nuget.org/packages/Microsoft.Extensions.DependencyInjection.Abstractions/8.0.2) (8.0.2)
- [Microsoft.Extensions.Options.ConfigurationExtensions](https://www.nuget.org/packages/Microsoft.Extensions.Options.ConfigurationExtensions/8.0.0) (8.0.0)
- [Microsoft.IdentityModel.JsonWebTokens](https://www.nuget.org/packages/Microsoft.IdentityModel.JsonWebTokens/8.13.0) (8.13.0)
- [Newtonsoft.Json](https://www.nuget.org/packages/Newtonsoft.Json/13.0.3) (13.0.3)
- [PowerShellStandard.Library](https://www.nuget.org/packages/PowerShellStandard.Library/5.1.1) (5.1.1)
- [System.Memory.Data](https://www.nuget.org/packages/System.Memory.Data/8.0.1) (8.0.1)

## コマンドレット

- ログイン
  - Connect-KshSite
  - Disconnect-KshSite
  - Get-KshCurrentConnection
  - Get-KshCurrentSite
  - Get-KshCurrentSiteCollection
  - Get-KshCurrentUser
  - Get-KshCurrentUserProfile
  - Get-KshCurrentUserProperty
  - Select-KshSite
  - Test-KshTenantSiteCollection
- サイト管理
  - 通知
    - Add-KshAlert
    - Get-KshAlert
    - Remove-KshAlert
    - Set-KshAlert
  - アプリ カタログ
    - Add-KshSiteCollectionAppCatalog
    - Get-KshSiteCollectionAppCatalog
    - Get-KshTenantAppCatalog
    - Remove-KshSiteCollectionAppCatalog
  - アプリ インスタンス
    - Get-KshAppInstance
  - アプリ
    - Add-KshApp
    - Get-KshApp
    - Remove-KshApp
    - Set-KshAppInstalled
    - Set-KshAppPublished
    - Update-KshApp
  - 添付ファイル
    - Get-KshAttachmentFile
    - Open-KshAttachmentFile
    - Remove-KshAttachmentFile
    - Save-KshAttachmentFile
  - 変更
    - Get-KshChange
  - クライアント コンポーネントのプロパティ
    - Add-KshStorageEntity
    - Get-KshStorageEntity
    - Remove-KshStorageEntity
  - 列
    - Add-KshColumnBoolean
    - Add-KshColumnCalculated
    - Add-KshColumnChoice
    - Add-KshColumnCurrency
    - Add-KshColumnDateTime
    - Add-KshColumnGeolocation
    - Add-KshColumnGuid
    - Add-KshColumnImage
    - Add-KshColumnLocation
    - Add-KshColumnLookup
    - Add-KshColumnMultiChoice
    - Add-KshColumnMultiLineText
    - Add-KshColumnNumber
    - Add-KshColumnTaxonomy
    - Add-KshColumnText
    - Add-KshColumnUrl
    - Add-KshColumnUser
    - Get-KshColumn
    - Remove-KshColumn
    - Set-KshColumnBoolean
    - Set-KshColumnCalculated
    - Set-KshColumnChoice
    - Set-KshColumnCurrency
    - Set-KshColumnDateTime
    - Set-KshColumnGeolocation
    - Set-KshColumnGuid
    - Set-KshColumnImage
    - Set-KshColumnLocation
    - Set-KshColumnLookup
    - Set-KshColumnMultiChoice
    - Set-KshColumnMultiLineText
    - Set-KshColumnNumber
    - Set-KshColumnTaxonomy
    - Set-KshColumnText
    - Set-KshColumnUrl
    - Set-KshColumnUser
  - コメント
    - Add-KshComment
    - Get-KshComment
    - Remove-KshComment
    - Set-KshCommentEnabled
  - コンテンツの承認
    - Set-KshApprovalStatus
  - コンテンツ タイプ
    - Add-KshContentType
    - Add-KshContentTypeColumn
    - Get-KshContentType
    - Get-KshContentTypeColumn
    - New-KshContentTypeId
    - Remove-KshContentType
    - Remove-KshContentTypeColumn
    - Set-KshContentType
    - Set-KshContentTypeColumn
    - Set-KshContentTypeColumnOrder
  - ドキュメント ライブラリ
    - Get-KshDocumentLibrary
  - ドキュメント セット テンプレート
    - Add-KshDocumentSetAllowedContentType
    - Add-KshDocumentSetDefaultDocument
    - Add-KshDocumentSetSharedColumn
    - Add-KshDocumentSetWelcomePageColumn
    - Get-KshDocumentSetAllowedContentType
    - Get-KshDocumentSetDefaultDocument
    - Get-KshDocumentSetSharedColumn
    - Get-KshDocumentSetWelcomePageColumn
    - Remove-KshDocumentSetAllowedContentType
    - Remove-KshDocumentSetDefaultDocument
    - Remove-KshDocumentSetSharedColumn
    - Remove-KshDocumentSetWelcomePageColumn
  - ドキュメント セット
    - Add-KshDocumentSet
  - ドキュメント
    - Add-KshDocument
  - ドライブ アイテム
    - Get-KshDriveItem
    - Get-KshSubDriveItem
  - ドライブ
    - Get-KshDrive
  - 外部共有
    - Get-KshSharingInfo
    - Get-KshSharingSettings
    - Test-KshExternalUserSharing
  - ファイル
    - Add-KshFile
    - Copy-KshFile
    - Get-KshFile
    - Move-KshFile
    - Open-KshFile
    - Remove-KshFile
    - Save-KshFile
    - Set-KshFileCheckOutStatus
    - Set-KshFilePublished
  - ファイル バージョン
    - Get-KshFileVersion
    - Remove-KshFileVersion
    - Restore-KshFileVersion
  - フォルダー
    - Add-KshFolder
    - Add-KshFolderColoring
    - Copy-KshFolder
    - Get-KshFolder
    - Get-KshSubFolder
    - Move-KshFolder
    - Remove-KshFolder
    - Set-KshFolder
    - Set-KshFolderColoring
  - グループ
    - Add-KshGroup
    - Add-KshGroupMember
    - Get-KshGroup
    - Get-KshGroupMember
    - Get-KshGroupOwner
    - Remove-KshGroup
    - Remove-KshGroupMember
    - Set-KshGroup
    - Set-KshGroupOwner
  - 強調表示
    - Add-KshHighlight
    - Remove-KshHighlight
  - 画像
    - Save-KshImage
  - いいね
    - Get-KshLike
    - Set-KshLike
  - リスト
    - Add-KshList
    - Get-KshList
    - Remove-KshList
    - Set-KshList
  - リスト アイテム
    - Add-KshListItem
    - Get-KshListItem
    - New-KshColumnGeolocationValue
    - New-KshColumnImageValue
    - New-KshColumnLookupValue
    - New-KshColumnTaxonomyValue
    - New-KshColumnUrlValue
    - New-KshColumnUserValue
    - Remove-KshListItem
    - Set-KshColumnTaxonomyValue
    - Set-KshListItem
  - リスト テンプレート
    - Get-KshListTemplate
  - ナビゲーション
    - Add-KshNavigationNode
    - Get-KshNavigation
    - Get-KshNavigationNode
    - Remove-KshNavigationNode
    - Set-KshNavigation
    - Set-KshNavigationNode
  - プロパティ
    - Get-KshProperty
  - ごみ箱
    - Get-KshRecycleBinItem
    - Move-KshRecycleBinItem
    - Remove-KshRecycleBinItem
    - Restore-KshRecycleBinItem
  - 地域と言語の設定
    - ConvertTo-KshLocalTime
    - ConvertTo-KshUniversalTime
    - Get-KshRegionalSettings
    - Set-KshRegionalSettings
    - Set-KshMultilingualEnabled
    - Add-KshSupportedUILanguage
    - Remove-KshSupportedUILanguage
  - アクセス許可
    - Add-KshRoleAssignment
    - Get-KshRoleAssignment
    - Remove-KshRoleAssignment
    - Set-KshUniqueRoleAssignmentEnabled
  - アクセス許可レベル
    - Add-KshRoleDefinition
    - Get-KshRoleDefinition
    - New-KshBasePermission
    - Remove-KshRoleDefinition
    - Set-KshRoleDefinition
  - 共有リンク
    - Add-KshAnonymousLink
    - Add-KshOrganizationSharingLink
    - Remove-KshAnonymousLink
    - Remove-KshOrganizationSharingLink
    - Test-KshSharingLink
  - サイト
    - Add-KshSite
    - Get-KshSite
    - Remove-KshSite
    - Set-KshSite
  - サイト コレクションの機能
    - Add-KshSiteCollectionFeature
    - Get-KshSiteCollectionFeature
    - Remove-KshSiteCollectionFeature
  - サイトの機能
    - Add-KshSiteFeature
    - Get-KshSiteFeature
    - Remove-KshSiteFeature
  - サイト ページ
    - Add-KshSitePage
    - Remove-KshSitePage
    - Set-KshSitePage
  - サイト テンプレート
    - Get-KshSiteTemplate
  - ユーザー
    - Add-KshExternalUser
    - Add-KshUser
    - Get-KshUser
    - Remove-KshUser
    - Resolve-KshUser
    - Set-KshUser
  - ユーザーの権限
    - Get-KshUserPermission
  - ユーザー プロパティ
    - Get-KshUserProperty
  - ビュー
    - Add-KshView
    - Add-KshViewColumn
    - Get-KshView
    - Get-KshViewColumn
    - Move-KshViewColumn
    - Remove-KshView
    - Remove-KshViewColumn
    - Set-KshView
    - Copy-KshView
  - Webhooks
    - Add-KshSubscription
    - Get-KshSubscription
    - Remove-KshSubscription
    - Set-KshSubscription
- テナント管理
  - 削除されたサイト コレクション
    - Get-KshTenantDeletedPersonalSiteCollection
    - Get-KshTenantDeletedSiteCollection
    - Remove-KshTenantDeletedSiteCollection
    - Restore-KshTenantDeletedSiteCollection
  - ファイル バージョン ポリシー
    - Get-KshTenantFileVersionPolicyForDocumentLibrary
    - Set-KshTenantFileVersionPolicy
    - Set-KshTenantFileVersionPolicyForDocumentLibrary
  - ホーム サイト
    - Get-KshTenantHomeSite
    - Remove-KshTenantHomeSite
    - Set-KshTenantHomeSite
  - ハブ サイト
    - Add-KshTenantHubSite
    - Get-KshTenantHubSite
    - Remove-KshTenantHubSite
    - Set-KshTenantHubSite
  - リスト デザイン
    - Add-KshTenantListDesign
    - Get-KshTenantListDesign
    - Remove-KshTenantListDesign
  - Office 365 CDN
    - Add-KshTenantCdnOrigin
    - Get-KshTenantCdnEnabled
    - Get-KshTenantCdnOrigin
    - Get-KshTenantCdnPolicy
    - Remove-KshTenantCdnOrigin
    - Set-KshTenantCdnEnabled
    - Set-KshTenantCdnPolicy
  - 組織のニュース サイト
    - Add-KshTenantOrganizationNewsSite
    - Get-KshTenantOrganizationNewsSite
    - Remove-KshTenantOrganizationNewsSite
  - 個人用サイト
    - Get-KshTenantPersonalSite
  - ルート サイト
    - Get-KshTenantRootSite
  - サイト コレクション
    - Add-KshTenantSiteCollection
    - Get-KshSiteCollection
    - Get-KshTenantSiteCollection
    - Lock-KshTenantSiteCollection
    - Remove-KshTenantSiteCollection
    - Set-KshTenantSiteCollection
    - Unlock-KshTenantSiteCollection
  - サイト スクリプト
    - Add-KshTenantSiteScript
    - Get-KshTenantSiteScript
    - Get-KshTenantSiteScriptFromList
    - Get-KshTenantSiteScriptFromSite
    - Remove-KshTenantSiteScript
  - サイト テンプレート
    - Get-KshTenantSiteTemplate
  - テナント
    - Get-KshTenant
    - Set-KshTenant
  - テーマ
    - Add-KshTenantTheme
    - Get-KshTenantTheme
    - Remove-KshTenantTheme
    - Set-KshTenantTheme
  - ユーザー
    - Add-KshTenantUser
    - Get-KshTenantExternalUser
    - Get-KshTenantUser
    - Remove-KshTenantExternalUser
    - Remove-KshTenantUser
    - Set-KshTenantUser
- 管理されたメタデータ
  - カスタム プロパティ
    - Add-KshTermCustomProperty
    - Add-KshTermLocalCustomProperty
    - Remove-KshTermCustomProperty
    - Remove-KshTermLocalCustomProperty
  - 用語グループ
    - Add-KshTermGroup
    - Get-KshTermGroup
    - Remove-KshTermGroup
    - Set-KshTermGroup
  - 用語ラベル
    - Add-KshTermLabel
    - Get-KshTermLabel
    - Remove-KshTermLabel
    - Set-KshTermLabel
  - 用語セット
    - Add-KshTermSet
    - Get-KshTermSet
    - Remove-KshTermSet
    - Set-KshTermSet
  - 用語ストア
    - Add-KshTermStoreLanguage
    - Get-KshTermStore
    - Remove-KshTermStoreLanguage
    - Set-KshTermStore
  - 用語
    - Add-KshTerm
    - Copy-KshTerm
    - Get-KshTerm
    - Get-KshTermDescription
    - Merge-KshTerm
    - Move-KshTerm
    - Remove-KshTerm
    - Set-KshTerm
    - Set-KshTermDescription
    - Set-KshTermDeprecated
